<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Echo AIO API: Introduction</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="EchoLogo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Echo AIO API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Categories</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Introduction </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_C__proj_AIO_AIOCommon_Doxygen_README"></a> The Echo AIO Test System is a modular platform for acoustic and audio testing. Echo provides a cross-platform shared API library for integrating an Echo AIO with your own custom software.</p>
<p >The API is packaged as shared library - EchoAIOInterface.dll for Windows (32-bit and 64-bit) and EchoAIOInterface.dylib for macOS. The macOS library supports Apple Silicon as well as Intel. API functions follow standard C calling conventions for their respective platforms.</p>
<p >To use the API, load the shared library just like any other. Be sure to call AIO_initialize to set up the DLL and then AIO_shutdown before closing the library.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Python example</h1>
<p >Here's how to use the API from a Python script. You'll need to install the ctypes library to access the shared library. This example demonstrates how to read the input gain setting.</p>
<div class="fragment"><div class="line"><span class="comment">#</span></div>
<div class="line"><span class="comment"># ctypes provides C compatible data types and allows calling functions in DLLs or shared libraries.</span></div>
<div class="line"><span class="comment">#</span></div>
<div class="line"><span class="keyword">import</span> ctypes</div>
<div class="line"><span class="keyword">import</span> os</div>
<div class="line"> </div>
<div class="line"><span class="comment">#</span></div>
<div class="line"><span class="comment">#    Look in the same directory as this script for the DLL. The default install location is C:\Progam Files\Echo AIO\CLI + API</span></div>
<div class="line"><span class="comment">#</span></div>
<div class="line">thisScriptFile = __file__</div>
<div class="line">thisScriptDir = os.path.dirname(thisScriptFile)</div>
<div class="line">echoaio = ctypes.WinDLL(thisScriptDir + <span class="stringliteral">&#39;\EchoAIOInterface.dll&#39;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment">#</span></div>
<div class="line"><span class="comment">#    Always call AIO_initialize() before calling any other function to set up the library.</span></div>
<div class="line"><span class="comment">#</span></div>
<div class="line">echoaio.AIO_initialize()</div>
<div class="line"> </div>
<div class="line"><span class="comment">#</span></div>
<div class="line"><span class="comment">#    Check if the AIO is connected</span></div>
<div class="line"><span class="comment"># </span></div>
<div class="line"><span class="keywordflow">if</span> (echoaio.AIO_isAIOConnected()):</div>
<div class="line">    <span class="comment">#</span></div>
<div class="line">    <span class="comment">#    Read the constant current state</span></div>
<div class="line">    <span class="comment">#    Note the use of ctypes.byref to pass the constantCurrentEnabled parameter by reference</span></div>
<div class="line">    <span class="comment"># </span></div>
<div class="line">    AIO_OK = 0</div>
<div class="line">    inputChannel = 1  <span class="comment"># MIC2</span></div>
<div class="line">    constantCurrentEnabled = ctypes.c_int(0)</div>
<div class="line">    status = echoaio.AIO_getConstantCurrentState(inputChannel, ctypes.byref(constantCurrentEnabled));</div>
<div class="line">    <span class="keywordflow">if</span> (status == AIO_OK):</div>
<div class="line">        print(<span class="stringliteral">&quot;Input channel &quot;</span> + str(inputChannel + 1) + <span class="stringliteral">&quot; CCP state is &quot;</span> + str(constantCurrentEnabled.value))</div>
<div class="line">    <span class="keywordflow">else</span>:</div>
<div class="line">        print(<span class="stringliteral">&quot;Unable to read CCP state on input channel &quot;</span> + str(inputChannel + 1))</div>
<div class="line"><span class="keywordflow">else</span>:</div>
<div class="line">    print(<span class="stringliteral">&quot;AIO not found&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment">#</span></div>
<div class="line"><span class="comment">#    Call AIO_shutdown() before unloading the library to release memory and resources</span></div>
<div class="line"><span class="comment">#</span></div>
<div class="line">echoaio.AIO_shutdown.restype = <span class="keywordtype">None</span></div>
<div class="line">echoaio.AIO_shutdown()</div>
</div><!-- fragment --><p> <br  />
 </p>
<h1><a class="anchor" id="autotoc_md2"></a>
C++ example</h1>
<p >For C++, accessing the API is similar. First, you will need to load the library and then get the function pointers from the library. Here's a C++ example demonstrating how to do this on Windows. </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Windows.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;../../EchoAIOInterface.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// APILibrary encapsulates loading API DLL and functions</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="preprocessor">#define LOAD_FUNCTION(functionName) loadFunction(#functionName, (void**)&amp;functionName)</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>APILibrary</div>
<div class="line">{</div>
<div class="line">    APILibrary()</div>
<div class="line">    {   </div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">        <span class="comment">// Look for the DLL in the working directory</span></div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">        std::string libraryName = <span class="stringliteral">&quot;EchoAIOInterface.dll&quot;</span>;</div>
<div class="line">        libraryHandle = LoadLibraryA(libraryName.c_str());</div>
<div class="line">        <span class="keywordflow">if</span> (<span class="keyword">nullptr</span> == libraryHandle)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Unable to load API library &quot;</span> + libraryName);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">        <span class="comment">// Load function pointers from DLL</span></div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">        LOAD_FUNCTION(<a class="code hl_function" href="group___library-startup-and-shutdown.html#ga1423191184834572394d1e12f98714a2">AIO_initialize</a>);</div>
<div class="line">        LOAD_FUNCTION(<a class="code hl_function" href="group___a_i_o-inquiry.html#ga68d2cf8ea6776651125932a3a4e2eeb0">AIO_isAIOConnected</a>);</div>
<div class="line">        LOAD_FUNCTION(<a class="code hl_function" href="group___a_i_o-mic-inputs.html#gaf35c14ad5f2c7ffaca1473ba40c8ebe6">AIO_getInputGain</a>);</div>
<div class="line">        LOAD_FUNCTION(<a class="code hl_function" href="group___library-startup-and-shutdown.html#gaf13fa1bd3932d12aa29eb7285ac929be">AIO_shutdown</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ~APILibrary()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (<span class="keyword">nullptr</span> != libraryHandle)</div>
<div class="line">        {</div>
<div class="line">            FreeLibrary(libraryHandle);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    void (*<a class="code hl_function" href="group___library-startup-and-shutdown.html#ga1423191184834572394d1e12f98714a2">AIO_initialize</a>)() = <span class="keyword">nullptr</span>;                     <span class="comment">// void AIO_initialize();</span></div>
<div class="line">    int (*<a class="code hl_function" href="group___a_i_o-inquiry.html#ga68d2cf8ea6776651125932a3a4e2eeb0">AIO_isAIOConnected</a>)() = <span class="keyword">nullptr</span>;                  <span class="comment">// int AIO_isAIOConnected();</span></div>
<div class="line">    int (*<a class="code hl_function" href="group___a_i_o-mic-inputs.html#gaf35c14ad5f2c7ffaca1473ba40c8ebe6">AIO_getInputGain</a>)(int, <span class="keywordtype">int</span>* <span class="keyword">const</span>) = <span class="keyword">nullptr</span>;     <span class="comment">// int AIO_getInputGain(int inputChannel, int* const gain);</span></div>
<div class="line">    void (*<a class="code hl_function" href="group___library-startup-and-shutdown.html#gaf13fa1bd3932d12aa29eb7285ac929be">AIO_shutdown</a>)() = <span class="keyword">nullptr</span>;                       <span class="comment">// void AIO_shutdown();</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">    HMODULE libraryHandle = <span class="keyword">nullptr</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> loadFunction(std::string functionName, <span class="keywordtype">void</span>** functionPointer)</div>
<div class="line">    {</div>
<div class="line">        *functionPointer = GetProcAddress(libraryHandle, functionName.c_str());</div>
<div class="line">        <span class="keywordflow">if</span> (<span class="keyword">nullptr</span> == *functionPointer)</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">throw</span> std::runtime_error(std::string{ <span class="stringliteral">&quot;Unable to load function &quot;</span> } + functionName);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Demonstrate how to read the input gain setting using the API</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordtype">void</span> readInputGainFromAIO(APILibrary <span class="keyword">const</span>&amp; apiLibrary)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// Always call AIO_initialize first</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    apiLibrary.AIO_initialize();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// Check if an AIO is connected</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="keywordflow">if</span> (apiLibrary.AIO_isAIOConnected())</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">        <span class="comment">// Read the input gain setting</span></div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">        <span class="keywordtype">int</span> inputChannel = 0; <span class="comment">// MIC1</span></div>
<div class="line">        <span class="keywordtype">int</span> gain = 0;</div>
<div class="line">        <span class="keywordtype">int</span> status = apiLibrary.AIO_getInputGain(inputChannel, &amp;gain);</div>
<div class="line">        <span class="keywordflow">if</span> (ECHO_AIO_OK == status)</div>
<div class="line">        {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Input channel &quot;</span> &lt;&lt; inputChannel + 1 &lt;&lt; <span class="stringliteral">&quot; gain is &quot;</span> &lt;&lt; gain;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">            std::cout &lt;&lt; <span class="stringliteral">&quot;Unable to read input gain; error &quot;</span> &lt;&lt; status;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">         std::cout &lt;&lt; <span class="stringliteral">&quot;No AIO connected&quot;</span>;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// Always call AIO_shutdown before unloading the DLL</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    apiLibrary.AIO_shutdown();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// main</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">        APILibrary apiLibrary;</div>
<div class="line"> </div>
<div class="line">        readInputGainFromAIO(apiLibrary);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">catch</span> (std::runtime_error&amp; e)</div>
<div class="line">    {</div>
<div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;Error: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup___a_i_o-inquiry_html_ga68d2cf8ea6776651125932a3a4e2eeb0"><div class="ttname"><a href="group___a_i_o-inquiry.html#ga68d2cf8ea6776651125932a3a4e2eeb0">AIO_isAIOConnected</a></div><div class="ttdeci">ECHO_AIO_API int AIO_isAIOConnected()</div><div class="ttdoc">Check if an AIO is connected to this computer.</div></div>
<div class="ttc" id="agroup___a_i_o-mic-inputs_html_gaf35c14ad5f2c7ffaca1473ba40c8ebe6"><div class="ttname"><a href="group___a_i_o-mic-inputs.html#gaf35c14ad5f2c7ffaca1473ba40c8ebe6">AIO_getInputGain</a></div><div class="ttdeci">ECHO_AIO_API int AIO_getInputGain(int inputChannel, int *const gain)</div><div class="ttdoc">Retrieves the gain value for the specified input channel, and stores the result in the memory locatio...</div></div>
<div class="ttc" id="agroup___library-startup-and-shutdown_html_ga1423191184834572394d1e12f98714a2"><div class="ttname"><a href="group___library-startup-and-shutdown.html#ga1423191184834572394d1e12f98714a2">AIO_initialize</a></div><div class="ttdeci">ECHO_AIO_API void AIO_initialize()</div><div class="ttdoc">Call AIO_initialize before calling any other library functions to set up the library.</div></div>
<div class="ttc" id="agroup___library-startup-and-shutdown_html_gaf13fa1bd3932d12aa29eb7285ac929be"><div class="ttname"><a href="group___library-startup-and-shutdown.html#gaf13fa1bd3932d12aa29eb7285ac929be">AIO_shutdown</a></div><div class="ttdeci">ECHO_AIO_API void AIO_shutdown()</div><div class="ttdoc">Call AIO_shutdown before unloading the library to release memory and resources.</div></div>
</div><!-- fragment --><p> <br  />
 Copyright (c) 2023 <a href="https://echotm.com/">Echo Test + Measurement</a> </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
